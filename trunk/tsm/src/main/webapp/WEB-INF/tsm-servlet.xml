<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
        "http://www.springframework.org/dtd/spring-beans-2.0.dtd">
<beans>

	<!-- maps request URLs to Controller names -->
	<bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping">
		<property name="interceptors">
			<list>
				<!-- so we can traverse hibernate lazy loaded collections, etc -->
				<ref bean="openSessionInViewInterceptor" /> 
			</list>
		</property>
	</bean>

	<!-- this bean with the well known name generates view names for us -->
	<!-- not strictly required since we just want to accept the defaults-->
	<bean id="viewNameTranslator"
		class="org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator" />

	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="prefix" value="/WEB-INF/jsp/" />
		<property name="suffix" value=".jsp" />
	</bean>

	<bean id="baseEventController" abstract="true"></bean>

	<!-- Controller names are not important when using the above HandlerMapping implementation -->
	<bean class="com.tech4d.tsm.web.SwitchBoardController" parent="baseEventController" >
		<property name="eventDao" ref="eventDao" />
	</bean>

	<bean id="eventFormValidator" class="com.tech4d.tsm.web.util.EventFormValidator"/>
	<bean class="com.tech4d.tsm.web.EventController" parent="baseEventController">
		<property name="bindOnNewForm" value="true" />
		<property name="commandName" value="event" />
		<property name="commandClass" value="com.tech4d.tsm.web.EventForm" />
		<property name="formView" value="event" />
		<property name="successView" value="redirect:eventsearch.htm" />
		<property name="eventDao" ref="eventDao" />
		<property name="validator" ref="eventFormValidator"/>
	</bean>

	<bean class="com.tech4d.tsm.web.ChangeHistoryController" parent="baseEventController">
		<property name="commandName" value="changeHistory"/>
		<property name="commandClass" value="com.tech4d.tsm.web.ChangeHistoryForm"/>
		<property name="formView" value="changehistory" />
		<property name="successView" value="changehistory" />
		<property name="auditEntryDao" ref="auditEntryDao" />
	</bean>

	<bean id="eventSearchFormValidator" class="com.tech4d.tsm.web.util.EventSearchFormValidator"/>
	<bean class="com.tech4d.tsm.web.EventSearchController" parent="baseEventController">
		<property name="commandName" value="eventSearch" />
		<property name="commandClass" value="com.tech4d.tsm.web.EventSearchForm" />
		<property name="formView" value="eventsearch" />
		<property name="successView" value="eventsearch" />
		<property name="eventSearchService" ref="eventSearchService" />
		<property name="validator" ref="eventSearchFormValidator"/>
	</bean>

</beans>
